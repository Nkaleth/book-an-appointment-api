#!/bin/bash -e

CONTAINER_ALREADY_STARTED="/tmp/CONTAINER_ALREADY_STARTED_PLACEHOLDER"
if [ ! -e $CONTAINER_ALREADY_STARTED ]; then
  touch $CONTAINER_ALREADY_STARTED
  echo "-- First container startup --"

  # If running the rails server then create or migrate existing database
  if [ "${*}" == "./bin/rails server" ]; then
    ./bin/rails db:create
    ./bin/rails db:prepare
    ./bin/rails db:seed
    :
  fi
else
  echo "-- Not first container startup --"
fi

exec "${@}"
